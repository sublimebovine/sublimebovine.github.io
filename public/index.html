<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Earth Engine Search</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjY3TDCL0By6QdJ_a1DQnLJTfL46_s-VI&libraries=places"></script>
  <style>
    body {
      font-family: 'Ubuntu', sans-serif;
    }

    #map {
      height: 100vh;
      width: 100%;
    }

    #search-box {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      width: 300px;
    }

    input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }

    #buttons {
      position: fixed;
      z-index: 1;
      display: flex;
      width: 100%;
      justify-content: end;
    }

    button {
      background-color: #0127E6;
      border: 2px solid rgba(0, 0, 0, 0.02);
      border-radius: 30px;
      width: 100px;
      cursor: pointer;
      padding: 10px;
      margin-right: 16px;
      margin-top: 10px;
      box-shadow: 0px 5px 20px rgba(0, 0, 0, 0.2);
      font-size: 20px;
      font-weight: bold;
      color: #D3DFF0;
    }

    #register {
      margin-right: 70px;
    }

    #logoutBtn{
      margin-right: 70px;
    }
  </style>
</head>
<body>
  <input id="search-box" type="text" placeholder="Search for a place...">
  
  <div id="buttons">
    <a href="login.html" id="login"><button id="loginBtn">Login</button></a>
    <a href="register.html" id="register"><button id="registerBtn">Register</button></a>
    <button id="logoutBtn" style="display: none;">Logout</button>
  </div>

  <div id="map"></div>

  <script>
    // Setup map
    function initMap() {
      const map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 0, lng: 0 },
        zoom: 2,
      });

      const searchBox = new google.maps.places.SearchBox(document.getElementById("search-box"));
      map.controls[google.maps.ControlPosition.TOP_CENTER].push(document.getElementById("search-box"));

      searchBox.addListener("places_changed", () => {
        const places = searchBox.getPlaces();
        if (places.length == 0) return;
        
        const place = places[0];
        if (!place.geometry) return;
        
        map.setCenter(place.geometry.location);
        map.setZoom(10);
      });
    }

    google.maps.event.addDomListener(window, "load", initMap);

    // Handle login state
    const isLoggedIn = localStorage.getItem('loggedIn') === 'true';
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const login = document.getElementById('login');
    const register = document.getElementById('register');
    const logoutBtn = document.getElementById('logoutBtn');

    if (isLoggedIn) {
      loginBtn.style.display = 'none';
      registerBtn.style.display = 'none';
      login.style.display = 'none';
      register.style.display = 'none';
      logoutBtn.style.display = 'inline-block';
    }

    logoutBtn.addEventListener('click', () => {
      localStorage.removeItem('loggedIn');
      location.reload(); // Refresh to reset UI
    });
  </script>
</body>
</html>
